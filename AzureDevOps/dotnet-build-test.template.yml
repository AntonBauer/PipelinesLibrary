parameters:
- name: Solution
  displayName: Solution
  type: string

- name: TestProjects
  displayName: Test Projects
  type: object

- name: CodeCoverageSettings
  displayName: Code coverage settings
  type: string

steps:
- task: DotNetCoreCLI@2
  displayName: Restore NuGet packages
  inputs:
    command: 'restore'
    projects: ${{parameters.Solution}}
    arguments: '--configuration Debug'
    verbosityRestore: 'Normal'

- task: DotNetCoreCLI@2
  displayName: Build for QA
  inputs:
    command: 'build'
    projects: ${{parameters.Solution}}
    arguments: '--configuration Debug --no-restore --no-incremental'

- task: DotNetCoreCLI@2
  displayName: Run Unit Tests
  inputs:
    command: 'test'
    projects: ${{parameters.TestProjects}}
    arguments: '--configuration Debug --no-build --collect:"XPlat Code Coverage" --settings ${{parameters.CodeCoverageSettings}}'
